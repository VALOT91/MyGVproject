{% extends '/base.html.twig' %}

{% block title %}detail{% endblock %}

{% block body %}
<div class="container   d-flex justify-content-center">
    <div class="container fnd bg-white pt-2 pb-4" >
       <div class="bg-white mx-4 mt-4   categoryMainImage" style="opacity:.90">
        {# bloc principal contenant les deux parties gauche et droite #}
        <div class=" mx-4 my-4  pt-4   row d-flex flex-wrap justify-content-around" >
            {# bloc gauche #}
            <aside  class="detailGammeSepDroite col-12 col-lg-6 col-md-6 d-flex flex-column align-items-center">
                <div class="text-center "  > 
                    <h1> {{ product.designation }} </h1>
                    <h6>{{ product.accroche }} </h6>
                     
                        {% if product.getProduitConditionnement() is not null  %} 
                            
                                <img id="img_{{ product.id }}"  src=" {{product.getProduitConditionnement().imagePath }}" class="detailGammeImg"  alt="image du produit choisi">
                        
                        {% endif %} 
                    
                </div>
                <div class=" d-flex flex-row justify-content-center "  > 
                    <div class="text-start w-100 "  > 
                            {% for item in product.getRecette() %}   
                                <div class="row w-100 d-flex align-items-center my-2">
                                    <div class="col-2"> 
                                        <img  style="width:4rem;objective-fit:cover" src=" \{{item.imagePath }}" class=""  alt="image de la recette">
                                    </div>
                                    <div class="col-10 mt-4" style="line-height:3px;"> 
                                        <strong><p style="font-size:medium" class="text-dark ms-2">{{ item.nom }} </p></strong>
                                        <p style="font-size:small;line-height:12px" class="ms-2">{{ item.description }} </p>
                                    </div>
                                </div>
                            {% endfor %}
                             {% if product.isBio  %} 
                                    <div class="row w-100 d-flex align-items-center my-4">
                                        <div class="col-2"> 
                                            <img src="/images/bio.png" style="width:3rem" class="ms-2"  alt="label bio">
                                        </div>
                                        <div class="col-10 mt-3" style="line-height:3px;"> 
                                            <strong><p class="ms-2 text-dark"> Certifié AB.</p></strong>
                                        </div>
                                    </div>
                            {% endif %} 
                    </div>
                </div>
               
            </aside>
            {# bloc droit #}
            <aside  class="detailGammedroite px-2 mb-4 pb-2 col-12 col-lg-6 col-md-6 d-flex flex-column align-items-center" >
                <div  class="detailGammeSepBasse detailGammeSepDescr w-100 d-flex flex-column align-items-center text-center pt-2" >
                    <h3 class="">Description </h3>
                    <p>{{ product.description }} </p>
                </div>
               
                <h3 class="my-2">Conditionnement disponibles </h3>
                <aside class="container   mt-2 d-flex flex-row justify-content-center w-100" >
                 {% if conditionnements |length < 4  %}
                   <div  class="  scoll-pane d-flex flex-row justify-content-between ">
                {% else %}  
                        <button onclick="sdb()"  class="  slideBt" type="button"><</button> 
                        <div id="containerSC" class="  scoll-pane d-flex flex-row justify-content-between ">
                {% endif  %}
                    {# Boucle sur les conditionnements disponibles #}
                    {% for conditionnement in conditionnements %}
                    <div class="text-center  "  >
                        
                            <input type="radio" onclick=choice(this) class="ulSc condit" name="{{product.id }}" checked="checked" id="{{ conditionnement.id }}" /> 
                            <label  for="{{ conditionnement.id }}" >
                                <img style="max-width:3rem;objective-fit:cover" src="{{ conditionnement.getConditionnement().imagepath }}"    alt="logo du conditionnement">
                            </label>
                            <p class="mt-1" style="font-size:x-small">{{conditionnement.getConditionnement().designation}}</p>
                            <h4 style="display:none" id="IM_{{ conditionnement.id }}"> {{ conditionnement.imagePath  }} </h4>
                                {% for tarif in conditionnement.tarifs %}

                                    {% if tarif.typePrix is same as "PRIX_PUBLIC" %} 
                                    <h4 style="display:none" id="PP_{{ conditionnement.id }}">
                                        {{  (tarif.prixUnitaire/100)|number_format(2, '.', ',') }}€
                                    </h4>
                                    {% endif %} 
                                {% if tarif.typePrix is same as "PRIX_PRO" %} 
                                    <h4 style="display:none" id="PR_{{ conditionnement.id }}">
                                        {% if app.user %}
                                            {% if app.user.roles[0] is same as "ROLE_CLIENT" or app.user.roles[0] is same as "ROLE_ADMIN" %}
                                                    {{  (tarif.prixUnitaire/100)|number_format(2, '.', ',') }}€
                                            {% endif %}  
                                        {% endif %} 
                                    </h4>
                                {% endif %} 
                            {% else %}
                                    <h4 style="display:none" id="PP_{{ conditionnement.id }}">
                                        N.C
                                    </h4> 
                                    <h4 style="display:none" id="PR_{{ conditionnement.id }}">
                                        N.C
                                    </h4>
                            {% endfor %}
                    </div>   

                    {% else %}
                            
                            <td colspan="15">Pas de conditionnement</td>
                        
                    {% endfor %}
               
                    
                </div>  
                  {% if conditionnements |length > 3  %}
                   <button  onclick="sdf()"  class=" slideBt" type="button">></button> 
                 {% endif  %} 
            </aside>
            {# tarifs #}
            <section class="pt-2 detailGammeSepHaute text-center">       
                {% if app.user %} 
                    {% if app.user.roles[0] is same as "ROLE_CLIENT" or app.user.roles[0] is same as "ROLE_ADMIN" %}
                            <h3>Tarif pros et public</h3>
                            <p> (Prix public TTC à titre indicatif dont tva 5.5%)</p>
                            <div class="mt-1" style="display:flex;flex-direction:row;justify-content:space-around;align-items:center ">
                                <div class="m-2" style="display:flex;flex-direction:column;algn-items:center;line-height:1px ">
                                    <h2  style="font-family:Segoe UI Semibold;font-weight:800;font-size:3rem"   id="selp_{{ product.id  }}"></h2>
                                    <p style="font-size:small">Votre prix unitaire pro H.T*</p>
                                </div>
                                <div class="m-2 text-secondary" style="display:flex;flex-direction:column;algn-items:center;line-height:0.51px ">
                                    <h2  style="font-family:Segoe UI Semibold;font-weight:800;font-size:2rem"   id="sel_{{ product.id  }}"></h2>
                                    <p style="font-size:x-small">Prix indicatif public TTC</p>
                                </div>
                            </div>
                            <p class="mt-4 mb-0" style="font-size:small">* Frais de port gratuits à partir de 200€ H.T en colissimo ou Mondial relay <a href="{{ path('ConditionsVente') }}"> (Voir Conditions) </a></p>
                            <br>
                    {% elseif  app.user.roles[0] is same as "ROLE_TRANSIT" %}
                            <h4>Tarif public T.T.C (Tva 5.5%)</h4>
                            <div class="mt-1" style="display:flex;flex-direction:row;justify-content:space-around;align-items:center ">
                                <div class="m-2 text-dark" style="display:flex;flex-direction:column;algn-items:center;line-height:0.51px ">
                                    <h2  style="font-family:Segoe UI Semibold;font-weight:800;font-size:3rem"   id="sel_{{ product.id  }}"></h2>
                                    <p style="font-size:small">Prix public TTC hors frais de port </p>
                                </div>
                                <div style="display:none;flex-direction:row">
                                    <h4> Votre tarif PRO HT : </H4> #}
                                    <h4 id="selp_{{ product.id  }}"></H4>
                                </div>  
                            </div>
                    {% else %}  
                            <div style="display:none;flex-direction:row">
                                <h4> Votre tarif PRO HT : </H4> #}
                                <h4 id="selp_{{ product.getProduct().id  }}"></H4>
                            </div>  
                    {% endif %}  
                        {# bouton du panier #}
                        <div class="mb-2" style="display:flex;flex-direction:row;justify-content:center">
                                    <a   id="pan_{{ product.id  }}" href="{{ path('cart_add',{'id': product.id }) }}" class="mb-2 btn btn-dark w-75">Ajouter au panier</a>
                        </div>
                {% else %}   
                        <div class="text-center">
                            <a class="nav-link" href="{{ path('app_login') }}">Connectez-vous pour voir les tarifs</a>
                        </div>
                {% endif %}                 
            </section>   
            {# Composition    #}
            <section  class="detailGammeSepHaute w-100 my-3 d-flex flex-column align-items-center"  >
                <h3 class="mt-3">Composition </h3>
                <p>{{ product.composition }} </p>
            </section>
        </div>
        <div  class="mx-2 ">
            <hr>
        </div>
        {# recommandations #}
        <div class="detailGammeReco w-100  mt-3" >
                            <div class="text-center">
                                <div> 
                                    <img  style="width:3rem;objective-fit:cover" src="/images/recomandations/balance.png" class=""  alt="image de la recette">
                                </div>
                                <div class=" mt-3 detailGammeinterligneReco"> 
                                    <strong><p style="font-size:medium" class="text-dark">{{ product.RecoDose }} </p></strong>
                                </div>
                            </div>
                            <div class="text-center">
                                <div> 
                                    <img  style="width:3rem;objective-fit:cover" src="/images/recomandations/chrono.png" class=""  alt="image de la recette">
                                </div>
                                <div class=" mt-3 detailGammeinterligneReco"> 
                                    <strong><p style="font-size:medium" class="text-dark">{{ product.RecoDuree }} </p></strong>
                                    
                                </div>
                            </div>
                            <div class="text-center">
                                <div> 
                                    <img  style="width:3rem;objective-fit:cover" src="/images/recomandations/Thermo2.png" class=""  alt="image de la recette">
                                </div>
                                <div class="detailGammeinterligneReco mt-3"> 
                                    <strong><p style="font-size:medium" class="text-dark">{{ product.Recotemp }} </p></strong>
                                    
                                </div>
                            </div>
                            <div  class="text-center">
                                <div> 
                                    <img  style="width:3rem;objective-fit:cover" src="/images/recomandations/calendar.png" class=""  alt="image de la recette">
                                </div>
                                <div class=" mt-3 detailGammeinterligneReco"> 
                                    <strong><p style="font-size:medium" class="text-dark">{{ product.RecoUsage }} </p></strong>
                                    
                                </div>
                            </div>
        </div>
    </div>
  </div>
</div>
{% endblock %}
